# å»ºé€ è€…æ¨¡å¼

è¯·é—®å¤§åé¼é¼çš„lombokç”¨è¿‡å—ï¼Ÿï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é¡¹ç›®ä¸­ç›´æ¥ä½¿ç”¨@Builderæ³¨è§£æ¥å……åˆ†ä½“éªŒä¸€ä¸‹å»ºé€ è€…æ¨¡å¼çš„é­…åŠ›ï¼Œæœ¬èŠ‚æˆ‘ä»¬è®²çš„æ˜¯å»ºé€ è€…æ¨¡å¼ï¼Œä¸‹é¢è·Ÿç€æˆ‘æ·±å…¥å»ºé€ è€…æ¨¡å¼çš„å†…éƒ¨ï¼Œæ·±åº¦æ¢ç©¶ä¸€ä¸‹å®ƒçš„å®ç°åŸç†å§~



## å»ºé€ è€…æ¨¡å¼æŠ½è±¡å›¾



![](http://image.tinx.top/img20210311111133.png)

æœ¬å›¾å‡ ä¹å°±å¯ä»¥å¾ˆç›´æ¥æ˜äº†çš„è¯´æ˜äº†å»ºé€ è€…æ¨¡å¼å°±æ˜¯æˆ‘ä»¬ä»0å¯¹ä¸€ä¸ªç›®æ ‡å¯¹è±¡ä¸æ–­ç»„è£…ï¼Œæœ€ç»ˆå¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„"æœºå™¨äºº"ï¼Œç»„è£…çš„æœºå™¨äººæŒ‰ç…§æˆ‘ä»¬çš„å£å‘³å¯ä»¥ä¸å°½ç›¸åŒã€‚



## çœŸå®åœºæ™¯

æˆ‘ä»¬ä¸¾ä¸€ä¸ªçœŸå®åœºæ™¯çš„æ¡ˆä¾‹å§ï¼š

â€‹	æˆ‘ä¹‹å‰çš„å…¬å¸æŠŠæˆ‘å¤–æ´¾åˆ°åŒ—äº¬TATAæœ¨é—¨åšJavaå¼€å‘ï¼Œçº¿ä¸Šç°åœ¨æœ‰ä¸€ä¸ªéœ€æ±‚ï¼Œå°±æ˜¯è¦æ¨å‡ºä¸åŒçš„å¥—é¤æœåŠ¡ï¼Œä¸€èˆ¬ä¼šæœ‰ï¼šæ¬§å¼è±ªåã€è½»å¥¢ç”°å›­ã€ç°ä»£ç®€çº¦ç­‰ç­‰ï¼Œè€Œè¿™äº›å¥—é¤çš„èƒŒåæ˜¯ä¸åŒçš„å•†å“ç»„åˆã€‚ä¾‹å¦‚ï¼šæ¬§å¼é™éŸ³é—¨ã€ç®€çº¦é—¨å¥—ã€é›•èŠ±å­é—¨ã€å“‘å…‰æ·¡é›…æ²¹æ¼†ç­‰ç­‰ç­‰ç­‰ï¼Œç„¶åæŒ‰ç…§ä¸åŒçš„å¥—é¤ä»·æ ¼é€‰å–ä¸åŒçš„å“ç‰Œç»„åˆï¼Œæœ€ç»ˆå†æŒ‰ç…§è£…ä¿®é¢ç§¯ç»™å‡ºä¸€ä¸ªæ•´ä½“çš„ä¿ä»·ã€‚

â€‹	è¿™â¾¥æˆ‘ä»¬å°±æ¨¡æ‹Ÿå…¬å¸æƒ³æ¨å‡ºâ¼€äº›å¥—é¤è£…ä¿®æœåŠ¡ï¼ŒæŒ‰ç…§ä¸åŒçš„ä»·æ ¼è®¾å®šå“ç‰Œé€‰æ‹©ç»„åˆï¼Œä»¥è¾¾åˆ°ä½¿â½¤å»ºé€ è€…æ¨¡å¼çš„è¿‡ç¨‹ã€‚



> ä»¥ä¸‹ä»£ç ï¼Œé™¤äº†è§„èŒƒçš„æ¥å£å¤–ï¼Œå…¶ä»–åŒç±»äº§å“éƒ½æœ‰ä¸¤ä¸ªå“ç‰Œï¼Œä¸åŒçš„ä»·æ ¼ï¼Œä¾›æˆ‘ä»¬æµ‹è¯•ç”¨ã€‚ è¿™é‡Œçš„å®ä½“ç±»ä»£ç å¯ä»¥ç•¥è¿‡ä¸çœ‹ï¼Œå› ä¸ºæ²¡å•¥çœ‹çš„

+ Main ï¼ˆæ¥å£ï¼Œè§„å®šäº†æ¯ä¸ªäº§å“çš„åŸºç¡€ä¿¡æ¯ï¼‰

```java
public interface Main {
    // åç§°
    String name();
    // å“ç‰Œ
    String brand();
    // ä»·æ ¼
    BigDecimal price();
    // æè¿°
    String desc();
}
```

+ ODoor (æ¬§å¼é—¨å®ä½“ç±»)

```java
public class ODoor implements Main{
    @Override
    public String name() {
        return "æ¬§å¼è½»å¥¢é™éŸ³é—¨";
    }

    @Override
    public String brand() {
        return "éš”å£è€ç‹";
    }

    @Override
    public BigDecimal price() {
        return new BigDecimal(3400);
    }

    @Override
    public String desc() {
        return "å¥¢åçš„æ¬§å¼é£æ ¼é™éŸ³é—¨ï¼Œè®©æ‚¨åœ¨é™è°§çš„ç”Ÿæ´»ä¸­äº«å—ä¸ä¸€æ ·çš„æ„Ÿè§‰";
    }
}
```

+ ZDoor(ä¸­å¼é—¨å®ä½“ç±»)

```java
public class ZDoor implements Main{
    @Override
    public String name() {
        return "ä¸­å¼å¥¢åé™éŸ³é—¨";
    }

    @Override
    public String brand() {
        return "ä¸­å";
    }

    @Override
    public BigDecimal price() {
        return new BigDecimal(3600);
    }

    @Override
    public String desc() {
        return "ä¸­å¼çš„å¥¢åä»¬ä¸é¦™ä¹ˆï¼Œå…„å¼Ÿä»¬ï¼";
    }
}
```

+ WChildDoor(å°ç‹å­é—¨å®ä½“ç±»)

```java
public class WChildDoor implements Main{
    @Override
    public String name() {
        return "ç®€çº¦å­é—¨";
    }

    @Override
    public String brand() {
        return "éš”å£å°ç‹";
    }

    @Override
    public BigDecimal price() {
        return new BigDecimal(1200);
    }

    @Override
    public String desc() {
        return "éš”å£å°ç‹ç‰Œï¼Œè´¨é‡é¡¶å‘±å‘±";
    }
}
```

+ HChildDoor(å˜¿å˜¿é—¨å®ä½“ç±»)

```java
public class HChildDoor implements Main{
    @Override
    public String name() {
        return "å“ˆå“ˆå­é—¨";
    }

    @Override
    public String brand() {
        return "å“ˆå“ˆ";
    }

    @Override
    public BigDecimal price() {
        return new BigDecimal(333);
    }

    @Override
    public String desc() {
        return "å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ";
    }
}
```

+ WDoorPocket(ç‹è€å®é—¨å¥—å®ä½“ç±»)

```java
public class WDoorPocket implements Main{
    @Override
    public String name() {
        return "ç‹è€å®é—¨å¥—";
    }

    @Override
    public String brand() {
        return "ç‹è€å®";
    }

    @Override
    public BigDecimal price() {
        return new BigDecimal(800);
    }

    @Override
    public String desc() {
        return "ç‹è€å®é—¨å¥—ï¼Œè¿™å°é—¨å¥—ï¼Œå˜å˜å¥½ï¼";
    }
}
```

+ JDoorPocket(æ¥ç›˜ä¾ é—¨å¥—å®ä½“ç±»)

```java
public class JDoorPocket implements Main{
    @Override
    public String name() {
        return "æ¥ç›˜ä¾ é—¨å¥—";
    }

    @Override
    public String brand() {
        return "æ¥ç›˜ä¾ ";
    }

    @Override
    public BigDecimal price() {
        return new BigDecimal(666.66);
    }

    @Override
    public String desc() {
        return "æˆ‘å°±æ˜¯æ¥ç›˜ä¾ ï¼Œæˆ‘ä¼šå¥½å¥½å¯¹å¾…ä»–çš„å­©å­çš„ï¼";
    }
}
```

+ YPaint(é›…åŠ›å£«æ²¹æ¼†å®ä½“ç±»)

```java
public class YPaint implements Main{
    @Override
    public String name() {
        return "æ£•è‰²å“‘å…‰æ²¹æ¼†";
    }

    @Override
    public String brand() {
        return "é›…åŠ›å£«";
    }

    @Override
    public BigDecimal price() {
        return new BigDecimal(88.88);
    }

    @Override
    public String desc() {
        return "å¥½ï¼ğŸ‘Œ";
    }
}
```

+ DPaint(å¤šä¹å£«æ²¹æ¼†)

```java
public class DPaint implements Main{
    @Override
    public String name() {
        return "æ£•è‰²äº®æ™¶æ™¶æ²¹æ¼†";
    }

    @Override
    public String brand() {
        return "å¤šä¹å£«";
    }

    @Override
    public BigDecimal price() {
        return new BigDecimal(66.66);
    }

    @Override
    public String desc() {
        return "ä¿ºè§‰å¾—ğŸ‘Œï¼";
    }
}
```



### ä¸ä½¿ç”¨è®¾è®¡æ¨¡å¼çš„ä»£ç ï¼š

```java
public class GoodsController {

    public CommonResult getMainList(Integer level){
        if(level == null) return CommonResult.faild();

        Map<String,Object> res = new HashMap<>();

        List<Main> goodsList = new ArrayList<>();
        BigDecimal price = BigDecimal.ZERO;

        if(level == 1){
            // æ¬§å¼è½»å¥¢é—¨
            ODoor oDoor = new ODoor();
            JDoorPocket jDoorPocket = new JDoorPocket();
            DPaint dPaint = new DPaint();
            HChildDoor hChildDoor = new HChildDoor();

            goodsList.add(oDoor);
            goodsList.add(jDoorPocket);
            goodsList.add(dPaint);
            goodsList.add(hChildDoor);

            price = price.add(oDoor.price()).add(jDoorPocket.price()).add(dPaint.price()).add(hChildDoor.price());
        }

        if(level == 2){
            // ä¸­å¼å¥¢åä»¬
            ZDoor zDoor = new ZDoor();
            WDoorPocket wDoorPocket = new WDoorPocket();
            WChildDoor wChildDoor = new WChildDoor();
            YPaint yPaint = new YPaint();

            goodsList.add(zDoor);
            goodsList.add(wDoorPocket);
            goodsList.add(wChildDoor);
            goodsList.add(yPaint);

            price = price.add(zDoor.price()).add(wDoorPocket.price()).add(yPaint.price()).add(wChildDoor.price());
        }

        if(level == 3){
            // å¥—é¤ 1
            ODoor oDoor = new ODoor();
            WDoorPocket wDoorPocket = new WDoorPocket();
            YPaint yPaint = new YPaint();
            WChildDoor wChildDoor = new WChildDoor();

            goodsList.add(oDoor);
            goodsList.add(wDoorPocket);
            goodsList.add(wChildDoor);
            goodsList.add(yPaint);

            price = price.add(oDoor.price()).add(wDoorPocket.price()).add(yPaint.price()).add(wChildDoor.price());
        }
        StringBuilder sb = new StringBuilder();
        goodsList.stream().forEach(data -> {
            sb.append("\r\nå•†å“ï¼š" + data.brand() + ":" + data.name() + ":" + data.desc());
        });
        res.put("goods",sb);
        res.put("price", price.setScale(2,BigDecimal.ROUND_HALF_UP));
        return CommonResult.ok(res);
    }
}
```

æµ‹è¯•ï¼š

```java
13:28:03.257 [main] INFO  com.wills.java.builder.simple.Test - CommonResult(res=OK, data={price=4466.32, goods=
å•†å“ï¼šéš”å£è€ç‹:æ¬§å¼è½»å¥¢é™éŸ³é—¨:å¥¢åçš„æ¬§å¼é£æ ¼é™éŸ³é—¨ï¼Œè®©æ‚¨åœ¨é™è°§çš„ç”Ÿæ´»ä¸­äº«å—ä¸ä¸€æ ·çš„æ„Ÿè§‰
å•†å“ï¼šæ¥ç›˜ä¾ :æ¥ç›˜ä¾ é—¨å¥—:æˆ‘å°±æ˜¯æ¥ç›˜ä¾ ï¼Œæˆ‘ä¼šå¥½å¥½å¯¹å¾…ä»–çš„å­©å­çš„ï¼
å•†å“ï¼šå¤šä¹å£«:æ£•è‰²äº®æ™¶æ™¶æ²¹æ¼†:ä¿ºè§‰å¾—ğŸ‘Œï¼
å•†å“ï¼šå“ˆå“ˆ:å“ˆå“ˆå­é—¨:å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ}, msg=null, reqToken=57220fe97e62472b87c6da5215a89bf1)
```

ç§ç§è¿™æ¶å¿ƒçš„ä»£ç ï¼Œçœ‹çš„çœŸçš„æ˜¯æƒ³åï¼Œæ¯ä¸€ä¸ªéƒ½è¦åˆ¤æ–­ä¸€æ¬¡ï¼Ÿå¦‚æœå˜æ¢äº†å¥—é¤è¿˜å¾—åŠ ä¸€ç§if else?è¿™å¤ªä¸ç°å®äº†



### ä½¿ç”¨è®¾è®¡æ¨¡å¼çš„ä»£ç 

å…¶å®ä½¿ç”¨å»ºé€ è€…æ¨¡å¼å¹¶ä¸éš¾ï¼Œä»–çš„æ ¸å¿ƒç±»å°±ä¸‰ä¸ª

1. Builder ï¼Œå»ºé€ è€…ç±»å…·ä½“çš„å„ç§ç»„è£…ç”±æ­¤ç±»å®ç°ã€‚

```java
public class Builder {

    public IMenu level1(){
        return new DecorationPackageMenu(1)
                .appendDoor(new ODoor())
                .appendChildDoor(new WChildDoor())
                .appendDoorPocket(new JDoorPocket())
                .appendPaint(new YPaint());
    }

    public IMenu level2(){
        return new DecorationPackageMenu(1)
                .appendDoor(new ZDoor())
                .appendChildDoor(new WChildDoor())
                .appendDoorPocket(new WDoorPocket())
                .appendPaint(new YPaint());
    }

    public IMenu level3(){
        return new DecorationPackageMenu(1)
                .appendDoor(new ODoor())
                .appendChildDoor(new HChildDoor())
                .appendDoorPocket(new JDoorPocket())
                .appendPaint(new YPaint());
    }

    public IMenu level4(){
        return new DecorationPackageMenu(1)
                .appendDoor(new ODoor())
                .appendChildDoor(new WChildDoor())
                .appendDoorPocket(new JDoorPocket())
                .appendPaint(new DPaint());
    }
}
```

2. IMenuï¼Œ å»ºé€ çš„æ¥å£ç±»

```java
public interface IMenu {
    // é—¨
    IMenu appendDoor(Main door);
    // å­é—¨
    IMenu appendChildDoor(Main door);
    // é—¨å¥—
    IMenu appendDoorPocket(Main door);
    // æ²¹æ¼†
    IMenu appendPaint(Main door);
  
  	String getDetail();
}
```

3. DecorationPackageMenu ï¼Œæ˜¯ IMenu æ¥â¼çš„å®ç°ç±»ï¼Œä¸»è¦æ˜¯æ‰¿è½½å»ºé€ è¿‡ç¨‹ä¸­çš„å¡«å……å™¨ã€‚ç›¸å½“äºè¿™æ˜¯â¼€å¥—æ‰¿è½½ç‰©æ–™å’Œåˆ›å»ºè€…ä¸­é—´è¡”æ¥çš„å†…å®¹ã€‚

```java
public class DecorationPackageMenu implements IMenu{

    private List<Main> list = new ArrayList<Main>(); // å¥—é¤æ¸…å•
    private BigDecimal price = BigDecimal.ZERO; // å¥—é¤ä»·æ ¼

    private Integer packetId;

    public DecorationPackageMenu(Integer packetId) {
        this.packetId = packetId;
    }

    @Override
    public IMenu appendDoor(Main door) {
        list.add(door);
        price = price.add(door.price());
        return this;
    }

    @Override
    public IMenu appendChildDoor(Main childDoor) {
        list.add(childDoor);
        price = price.add(childDoor.price());
        return this;
    }

    @Override
    public IMenu appendDoorPocket(Main doorPocket) {
        list.add(doorPocket);
        price = price.add(doorPocket.price());
        return this;
    }

    @Override
    public IMenu appendPaint(Main paint) {
        list.add(paint);
        price = price.add(paint.price());
        return this;
    }

    @Override
    public String getDetail(){
        StringBuilder sb = new StringBuilder();
        sb.append("\r\n----------å¥—é¤" + this.packetId +"-------------\r\n");
        sb.append("æ€»ä»·ï¼š" + this.price.setScale(2,BigDecimal.ROUND_HALF_UP) + "\r\n");
        for (Main main : list) {
            sb.append("å•†å“ï¼š" + main.brand());
            sb.append("åç§°ï¼š" + main.name());
            sb.append("ä»·æ ¼ï¼š" + main.price().setScale(2,BigDecimal.ROUND_HALF_UP));
            sb.append("ä»‹ç»ï¼š" + main.desc());
        }
        sb.append("\r\n-------------------------------------------------\r\n");
        return sb.toString();
    }
}
```

æµ‹è¯•ç”¨ä¾‹ï¼š

```java
@Slf4j
public class Test {

    @org.junit.Test
    public void test(){
        Builder builder = new Builder();
        log.info(builder.level1().getDetail());
    }
}
```

è¾“å‡ºï¼š

```console
13:52:14.711 [main] INFO  com.wills.java.builder.upgrade.Test - 
----------å¥—é¤1-------------
æ€»ä»·ï¼š5355.54
å•†å“ï¼šéš”å£è€ç‹åç§°ï¼šæ¬§å¼è½»å¥¢é™éŸ³é—¨ä»·æ ¼ï¼š3400.00ä»‹ç»ï¼šå¥¢åçš„æ¬§å¼é£æ ¼é™éŸ³é—¨ï¼Œè®©æ‚¨åœ¨é™è°§çš„ç”Ÿæ´»ä¸­äº«å—ä¸ä¸€æ ·çš„æ„Ÿè§‰å•†å“ï¼šéš”å£å°ç‹åç§°ï¼šç®€çº¦å­é—¨ä»·æ ¼ï¼š1200.00ä»‹ç»ï¼šéš”å£å°ç‹ç‰Œï¼Œè´¨é‡é¡¶å‘±å‘±å•†å“ï¼šæ¥ç›˜ä¾ åç§°ï¼šæ¥ç›˜ä¾ é—¨å¥—ä»·æ ¼ï¼š666.66ä»‹ç»ï¼šæˆ‘å°±æ˜¯æ¥ç›˜ä¾ ï¼Œæˆ‘ä¼šå¥½å¥½å¯¹å¾…ä»–çš„å­©å­çš„ï¼å•†å“ï¼šé›…åŠ›å£«åç§°ï¼šæ£•è‰²å“‘å…‰æ²¹æ¼†ä»·æ ¼ï¼š88.88ä»‹ç»ï¼šå¥½ï¼ğŸ‘Œ
-------------------------------------------------
```



ä¸Šé¢ä½¿ç”¨è®¾è®¡æ¨¡å¼çš„å…³é”®ç‚¹å°±åœ¨```IMenu```æ¥å£ä¸Šï¼Œå¯ä»¥è‡ªç”±æ‹¼è£…æˆ‘ä»¬éœ€è¦çš„ä¸œè¥¿ï¼Œç„¶åä¸€è‚¡è„‘çš„è¿”å›ï¼Œæ˜¯ä¸æ˜¯å¾ˆå¥½ç©å‘¢ï¼Ÿ



å¥½äº†ï¼Œè¿™å°±æ˜¯å»ºé€ è€…æ¨¡å¼ï¼Œè›®ç®€å•çš„ï¼Œä½†æ˜¯ç”¨å¤„æŒºå¤§çš„ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­ä¼šé‡åˆ°å¾ˆå¤šå‚æ•°ä¸åŒï¼Œç›®çš„ç›¸åŒçš„ä¸œè¥¿ï¼Œä¸å¦¨æˆ‘ä»¬éƒ½å¯ä»¥é‡ç½®æˆ å»ºé€ è€…æ¨¡å¼ï¼Œå²‚ä¸æ˜¯èŠ‚çœæ—¶é—´å»æ‘¸é±¼äº†ï¼Ÿ/æ»‘ç¨½



æ€»ç»“ï¼š

+ é€šè¿‡ä¸Šâ¾¯å¯¹å»ºé€ è€…æ¨¡å¼çš„ä½¿â½¤ï¼Œå·²ç»å¯ä»¥æ‘¸ç´¢å‡ºâ¼€ç‚¹â¼¼å¾—ã€‚é‚£å°±æ˜¯ä»€ä¹ˆæ—¶å€™ä¼šé€‰æ‹©è¿™æ ·çš„è®¾è®¡æ¨¡å¼ï¼Œå½“ï¼š``` â¼€äº›åŸºæœ¬ç‰©æ–™ä¸ä¼šå˜ï¼Œâ½½å…¶ç»„åˆç»å¸¸å˜åŒ–çš„æ—¶å€™``` ï¼Œå°±å¯ä»¥é€‰æ‹©è¿™æ ·çš„è®¾è®¡æ¨¡å¼æ¥æ„å»ºä»£ç ã€‚

+ æ­¤è®¾è®¡æ¨¡å¼æ»¡â¾œäº†å•â¼€èŒè´£åŸåˆ™ä»¥åŠå¯å¤â½¤çš„æŠ€æœ¯ã€å»ºé€ è€…ç‹¬â½´ã€æ˜“æ‰©å±•ã€ä¾¿äºæ§åˆ¶ç»†èŠ‚â»›é™©ã€‚ä½†åŒæ—¶å½“å‡ºç°ç‰¹åˆ«å¤šçš„ç‰©æ–™ä»¥åŠå¾ˆå¤šçš„ç»„åˆåï¼Œç±»çš„ä¸æ–­æ‰©å±•ä¹Ÿä¼šé€ æˆéš¾ä»¥ç»´æŠ¤çš„é—®é¢˜ã€‚ä½†è¿™ç§è®¾è®¡ç»“æ„æ¨¡å‹å¯ä»¥æŠŠé‡å¤çš„å†…å®¹æŠ½è±¡åˆ°æ•°æ®åº“ä¸­ï¼ŒæŒ‰ç…§éœ€è¦é…ç½®ã€‚è¿™æ ·å°±å¯ä»¥å‡å°‘ä»£ç ä¸­â¼¤é‡çš„é‡å¤ã€‚

+ è®¾è®¡æ¨¡å¼èƒ½å¸¦ç»™ä½ çš„æ˜¯â¼€äº›æ€æƒ³ï¼Œä½†åœ¨å¹³æ—¶çš„å¼€å‘ä¸­æ€ä¹ˆæ ·æ¸…æ™°çš„æç‚¼å‡ºç¬¦åˆæ­¤æ€è·¯çš„å»ºé€ æ¨¡å—ï¼Œæ˜¯â½è¾ƒéš¾çš„ã€‚éœ€è¦ç»è¿‡â¼€äº›é”»ç‚¼å’Œä¸æ–­æ‰¿æ¥æ›´å¤šçš„é¡¹â½¬ï¼Œä»â½½è·å¾—è¿™éƒ¨åˆ†ç»éªŒã€‚æœ‰çš„æ—¶å€™ä½ çš„ä»£ç å†™çš„å¥½ï¼Œå¾€å¾€æ˜¯å€’é€¼çš„ï¼Œå¤æ‚çš„ä¸šåŠ¡é¢‘ç¹çš„å˜åŒ–ï¼Œä¸æ–­çš„æŒ‘æˆ˜ï¼