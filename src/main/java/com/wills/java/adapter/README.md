# é€‚é…å™¨æ¨¡å¼

è¿™ä¸ªè®¾è®¡æ¨¡å¼è§åçŸ¥æ„ï¼Œå°±æ˜¯åº”å¯¹ä¸åŒçš„åœºåˆï¼Œæˆ‘ä»¬ä½¿ç”¨é€‚é…å™¨æ¥åº”å¯¹ä¸åŒçš„ç¯å¢ƒã€‚

å¦‚æœå¤§å®¶æŠ€æœ¯è¿˜å¯ä»¥çš„è¯ï¼Œè‚¯å®šä¼šå»å°è¯•å»è¯»ä¸€ä¸‹æˆ‘ä»¬æ—¥å¸¸å¼€å‘çš„æ¡†æ¶ï¼Œæ¯”å¦‚è¯´ SpringBoot / Mybatis / springcloud alibaba nacos ç­‰ç­‰ç­‰ï¼Œå¦‚æœé˜…è¯»è¿‡æºç çš„è¯ï¼Œè‚¯å®šè§è¿‡è›®å¤šåå­—åç¼€ä¸ºAdapterçš„ç±»ï¼Œè¿™äº›ç±»å°±æ˜¯æˆ‘ä»¬æœ¬èŠ‚è¦è®¨è®ºçš„é€‚é…å™¨æ¨¡å¼çš„äº§ç‰©ï¼Œç°åœ¨å¯¹è¿™ä¸ªé€‚é…å™¨æ¨¡å¼æœ‰äº†ä¸€äº›æ¦‚å¿µä»¥åï¼Œæˆ‘ä»¬å°±å¼€å§‹æœ¬èŠ‚è¯¾çš„å­¦ä¹ å§~ï¼



## æƒ…å¢ƒå¯¼å…¥

![](https://img2018.cnblogs.com/blog/1272523/201901/1272523-20190129142942342-2089942613.png)

![](https://img2018.cnblogs.com/blog/1272523/201901/1272523-20190129143032772-477362990.png)

å¤§å®¶å¦‚æœæœ‰æ¥è§¦è¿‡ PS4 PS5 XBOXç­‰æ¸¸æˆæœºçš„éƒ½çŸ¥é“ï¼Œå› ä¸ºæŸäº›æ”¿ç­–åŸå› ï¼Œæˆ‘ä»¬å¤§é™†åœ°åŒºæ— æ³•ç©åˆ°è¡€è…¥æš´åŠ›çš„æ¸¸æˆï¼Œä½†æ˜¯æ°å·§é‚£ç§æ¸¸æˆæ‰æ˜¯çœŸæ­£çš„å¤§ä½œï¼Œé‚£æ€ä¹ˆåŠï¼Ÿæˆ‘ä»¬å°±åªèƒ½å»è´­ä¹° æ¸¯ç‰ˆæœºå™¨ï¼Œè¿™ç§åœ°åŒºçš„æœºå™¨ä¸ä¼šå­˜åœ¨é”åŒºé”æ¸¸æˆçš„é—®é¢˜ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯ï¼Œæ¸¯ç‰ˆæ¸¸æˆæœºé‡‡ç”¨äº†å¤–å›½çš„ç”µæºæ ‡å‡†ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬çš„ç”µæºçº¿æ’å¤´å¤„å¿…é¡»è¦å‡†å¤‡ä¸€ä¸ªç”µæº**é€‚é…å™¨**ï¼Œé€‚é…å™¨çš„ä½œç”¨å°±æ˜¯å°†ä¹‹å‰çš„ä¸œè¥¿è½¬æ¢ä¸ºæˆ‘ä»¬ç°åœ¨éœ€è¦çš„ä¸œè¥¿ã€‚



## é¡¹ç›®æ¨¡æ‹Ÿ

å‡è®¾æˆ‘ä»¬çš„å…¬å¸å‘å±•å‰æ™¯éå¸¸å¥½ï¼Œå½“åŸºç¡€çš„ç³»ç»Ÿé€æ¸æˆå‹åï¼Œä¸šåŠ¡è¿è¡Œå°±éœ€è¦å¼€å§‹åšç”¨æˆ·çš„æ‹‰æ–°å’Œä¿ƒæ´»ï¼Œä»è€Œä¿éšœæ–°ç”¨æˆ·çš„å¢åŠ ä»¥åŠæœ€ç»ˆçš„ç°é‡‘è½¬æ¢ã€‚

ç†Ÿæ‚‰æ‹¼å¤šå¤šçš„éƒ½çŸ¥é“ï¼Œä»–ä»¬çš„è¥é”€ä¹‹ä¸€å°±æ˜¯ï¼š ä½ é‚€è¯·â¼€ä¸ªâ½¤æˆ·å¼€æˆ·ã€æˆ–è€…é‚€è¯·â¼€ä¸ªâ½¤æˆ·ä¸‹å•ï¼Œé‚£ä¹ˆå¹³å°å°±ä¼šç»™ä½ è¿”åˆ©ï¼Œå¤šé‚€å¤šå¾—ã€‚åŒæ—¶éšç€æ‹‰æ–°çš„é‡è¶Šæ¥è¶Šå¤šå¼€å§‹è®¾ç½®æ¯â½‰ä¸‹å•éƒ½ä¼šç»™â¾¸å•å¥–åŠ±ï¼Œç­‰ç­‰ï¼Œå„ç§è¥é”€åœºæ™¯ã€‚

**é‚£ä¹ˆè¿™ä¸ªæ—¶å€™åšè¿™æ ·â¼€ä¸ªç³»ç»Ÿå°±ä¼šæ¥æ”¶å„ç§å„æ ·çš„MQæ¶ˆæ¯æˆ–è€…æ¥â¼ï¼Œå¦‚æœâ¼€ä¸ªä¸ªçš„å»å¼€å‘ï¼Œå°±ä¼šè€—è´¹å¾ˆâ¼¤çš„æˆæœ¬ï¼ŒåŒæ—¶å¯¹äºåæœŸçš„æ‹“å±•ä¹Ÿæœ‰â¼€å®šçš„éš¾åº¦ã€‚æ­¤æ—¶å°±ä¼šå¸Œæœ›æœ‰â¼€ä¸ªç³»ç»Ÿå¯ä»¥é…ç½®â¼€ä¸‹å°±æŠŠå¤–éƒ¨çš„MQæ¥â¼Šè¿›â¾ï¼Œè¿™äº›MQå°±åƒä¸Šâ¾¯æåˆ°çš„å¯èƒ½æ˜¯â¼€äº›æ³¨å†Œå¼€æˆ·æ¶ˆæ¯ã€å•†å“ä¸‹å•æ¶ˆæ¯ç­‰ç­‰**

é‚£ä¹ˆè¿™ç§åœºæ™¯å¯ä»¥ç”¨åˆ°é€‚é…å™¨æ¨¡å¼å˜›ï¼Ÿç­”æ¡ˆæ˜¯å¯ä»¥çš„ï¼

ä»¥ä¸‹æ˜¯ç³»ç»Ÿå†…é€šç”¨çš„ç±»ï¼Œä¾›æˆ‘ä»¬æµ‹è¯•ä½¿ç”¨

+ ç”¨æˆ·æ³¨å†Œå®ä½“ç±»

```java
@Data
public class CreateUser {

    private Integer id;
    private String userName;
    private String pwd;
    private Date createTime;
    private String remark;
    private Integer type;
}
```

+ è®¢å•å®ä½“ç±»

```java
@Data
public class CreateUser {

    private Integer id;
    private String userName;
    private String pwd;
    private Date createTime;
    private String remark;
    private Integer type;
}
```



## é€šç”¨è§£å†³æ–¹æ¡ˆ

å¦‚æœæˆ‘ä»¬å¹³å¸¸è§£å†³å¤šä¸ªMQæ¶ˆæ¯ï¼Œç„¶ååˆ†åˆ«å¤„ç†ä¸€èˆ¬éƒ½æ˜¯æœ‰å‡ ä¸ªä¸šåŠ¡ï¼Œæˆ‘ä»¬å°±å»ºç«‹å‡ ä¸ªç±»ï¼Œç„¶ååœ¨å…¶ä¸­å¤„ç†å°±OKäº†ï¼Œä¸‹é¢æ˜¯ç¤ºä¾‹ä»£ç ï¼š

```java
@Slf4j
public class CreateMQ {

    public void onMessage(String message){
        CreateUser user = JSON.parseObject(message, CreateUser.class);
        // å¤„ç†ç›¸å…³çš„ä¸šåŠ¡ ...
    }
}
```



ä½†æ˜¯ï¼Œè€ƒè™‘ä¸€ä¸‹ï¼Œæˆ‘ä»¬è¦å¤„ç†çš„MQä¸šåŠ¡ç‰¹åˆ«å¤šï¼Œæœ‰100+å’‹åŠï¼Ÿæ¯ä¸ªéƒ½å»ºä¸ªç±»ï¼Ÿè¿™ä¸å¯èƒ½å§ï¼Ÿï¼Ÿï¼Ÿ

æ‰€ä»¥ï¼Œè¿™æ—¶å€™ é€‚é…å™¨æ¨¡å¼å°±æ˜¾å¾—ç‰¹åˆ«é‡è¦äº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä½¿ç”¨é€‚é…å™¨æ¨¡å¼æ¥ä¼˜åŒ–ä¸€ä¸‹å§~



## é€‚é…å™¨æ¨¡å¼

> é€‚é…å™¨æ¨¡å¼è¦è§£å†³çš„ä¸»è¦é—®é¢˜å°±æ˜¯å¤šç§å·®å¼‚åŒ–ç±»å‹çš„æ¥â¼åšç»Ÿâ¼€è¾“å‡ºï¼Œè¿™åœ¨æˆ‘ä»¬å­¦ä¹ â¼¯â¼šâ½…æ³•æ¨¡å¼ä¸­ä¹Ÿæœ‰æ‰€æåˆ°ä¸åŒç§ç±»çš„å¥–å“å¤„ç†ï¼Œå…¶å®é‚£ä¹Ÿæ˜¯é€‚é…å™¨çš„åº”â½¤ã€‚

### é€‚é…å™¨æ¨¡å‹ç»“æ„

![](http://image.tinx.top/img20210315115507.png)

+ ç»Ÿä¸€çš„MQæ¶ˆæ¯ä½“

```java
@Data
public class RebateInfo {

    private String userId;
    private String bizId;
    private Date biaTime;
    private String desc;
}
```

+ MQé€‚é…æ¶ˆæ¯é€‚é…

> è¿™ä¸ªç±»é‡Œé¢çš„æ–¹æ³•ï¼Œå°±æ˜¯ç”¨äºæŠŠä¸åŒçš„MQè½¬æ¢æˆæˆ‘ä»¬è¦çš„å„ç§å±æ€§ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆæ–¹æ³•ä¸Šé¢æ˜¯Mapå‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¬æ¥æ”¶çš„ä¿¡æ¯å‡ ä¹éƒ½æ˜¯jsonä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥å°† jsonè½¬æ¢ä¸ºmapï¼Œè¿™æ ·å°±ä¸éœ€è¦é€‚é…å®ä½“ç±»äº†ï¼Œç„¶åç”¨åå°„å°†mapè½¬æ¢ä¸ºæˆ‘ä»¬ä¸Šé¢å†™çš„ç»Ÿä¸€çš„MQæ¶ˆæ¯ä½“

```java
public class MQAdapter {

public static RebateInfo filter(String strJson, Map<String, String>
        link) throws Exception{
    return filter(JSON.parseObject(strJson, Map.class), link);
}

public static RebateInfo filter(Map obj, Map<String, String> link)
        throws Exception{
    RebateInfo rebateInfo = new RebateInfo();
    for (String key : link.keySet()) {
        Object val = obj.get(link.get(key));
        RebateInfo.class.getMethod("set" + key.substring(0, 1).toUpperCase() + key.substring(1), String.class)
                .invoke(rebateInfo, val.toString());
    }
    return rebateInfo;
}
```



å¥½äº†ï¼Œé€‚é…å·²ç»oKäº†ï¼Œå¯ä»¥è¿›è¡Œæµ‹è¯•äº†ï¼

```java
public class Test {

    @org.junit.Test
    public void test() throws Exception {
        CreateUser createUser = new CreateUser();
        createUser.setCreateTime(new Date().toString());
        createUser.setUserName("éš”å£è€ç‹å‘€ï¼");
        createUser.setPwd(MessageDigest.getInstance("md5").digest("12345".getBytes()).toString());
        createUser.setType(1);

        // å®šä¹‰è½¬æ¢çš„Map
        Map<String,String> link1 = new HashMap<>();
        link1.put("userId","userId");
        link1.put("bizTime","createTime");
        link1.put("name","userName");
        link1.put("type","type");
        link1.put("desc","pwd");

        RebateInfo filter = MQAdapter.filter(JSON.toJSONString(createUser), link1);
        System.out.println(filter);
        System.out.println("---------------------------------------------");
        Order order = new Order();
        order.setOrderId("123456");
        order.setOrderTime(new Date().toString());
        order.setPrice(new BigDecimal(7));
        order.setSku("df23tg4d");
        order.setSkuName("æµ‹è¯•");

        // å®šä¹‰è½¬æ¢çš„Map
        Map<String,String> link2 = new HashMap<>();
        link2.put("bizId","orderId");
        link2.put("bizTime","String");
        link2.put("name","skuName");
        link2.put("type","sku");
        link2.put("desc","price");

        System.out.println(MQAdapter.filter(JSON.toJSONString(order), link2));
    }
}
```

è¿è¡Œç­”æ¡ˆï¼š

```console
RebateInfo(userId=null, name=éš”å£è€ç‹å‘€ï¼, bizId=null, bizTime=Mon Mar 15 13:27:45 CST 2021, desc=[B@78e03bb5, type=1)
---------------------------------------------
RebateInfo(userId=null, name=æµ‹è¯•, bizId=123456, bizTime=Mon Mar 15 13:27:45 CST 2021, desc=7, type=df23tg4d)
```



ä½¿ç”¨è¿™ä¸€ä¸ªç±»ï¼Œå°±å¯ä»¥ç›´æ¥è½¬æ¢æˆ‘ä»¬æ¥æ”¶çš„ä¿¡æ¯ç„¶åè½¬æ¢æˆç»Ÿä¸€çš„å®ä½“ç±»ï¼Œå°±å¯ä»¥è¿›è¡Œç›¸å…³çš„æ“ä½œäº†~ï¼



å¦‚æœæ˜¯æ¥å£çš„é€‚é…å™¨ï¼Œé‚£ä¹ˆå°±æ˜¯å†™ä¸€ä¸ªæ¥å£ï¼Œæä¾›åŒä¸€ä¸ªæ–¹æ³•ï¼Œæœ€åç›¸å…³æ–¹æ³•å®ç°ï¼Œç„¶åæ‰§è¡Œå³å¯ï¼Œå·®ä¸å¤šå°±æ˜¯æˆ‘ä»¬å¹³å¸¸å¼€å‘ç»å¸¸ä½¿ç”¨çš„ Interface + implementæ–¹å¼ï¼Œåœ¨è¿™é‡Œå°±ä¸åšä»‹ç»äº†ã€‚



æ€»ç»“ï¼š 

+ ä½¿ç”¨é€‚é…å™¨æ¨¡å¼ï¼Œå¯ä»¥è®©æˆ‘ä»¬å‡å°‘å¾ˆå¤šä¸å¿…è¦çš„åˆ›å»ºç±» + é€»è¾‘ï¼Œå‡å°‘äº†å¤§é‡é‡å¤çš„åˆ¤æ–­ ä¹Ÿä½¿é¡¹ç›®æ›´åŠ æ˜“äºæ‰©å±•



å­¦ä¹ è®¾è®¡æ¨¡å¼ä¸ä¸€å®šéè¦éµå¾ªæˆ‘ä¸Šé¢çš„ä¾‹å­æ¥ï¼Œä½†æ˜¯é‡Œé¢çš„ç²¾é«“ä»¥åŠæ„è¯†ä¸€å®šè¦åœ¨ä»¥åçš„ç¼–ç å‰è¦æƒ³ä¸€ä¸‹ï¼Œæ˜¯å¦å¯ä»¥ä½¿ç”¨ç›¸å…³è®¾è®¡æ¨¡å¼è®©æˆ‘ä»¬çš„ä»£ç æ›´åŠ ç®€å•é«˜æ•ˆï¼Œè¯´ä¸å®šè¿˜èƒ½çœå‡ºæ¥**æ‘¸é±¼**çš„æ—¶é—´å‘¢ï¼ŸğŸ˜



